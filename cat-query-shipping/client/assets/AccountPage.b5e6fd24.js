var H=Object.defineProperty;var V=Object.getOwnPropertySymbols;var J=Object.prototype.hasOwnProperty,K=Object.prototype.propertyIsEnumerable;var D=(a,o,i)=>o in a?H(a,o,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[o]=i,F=(a,o)=>{for(var i in o||(o={}))J.call(o,i)&&D(a,i,o[i]);if(V)for(var i of V(o))K.call(o,i)&&D(a,i,o[i]);return a};import{a as h,c as A,s as Q,ab as W,A as X,b as G,v as Y,o as d,d as r,e,g as $,x as y,Z as ee,t as n,a0 as te,i as u,q,f as oe,F as U,j as R,p as le,m as se,ac as ae,n as ce}from"./vendor.80559bff.js";import{a as z,l as k,A as _,_ as ie,b as Z,P as T,d as de}from"./index.e938760b.js";class re{async getProfiles(){let o=await z.get("api/profiles");k.log(o.data),_.profiles=o.data,this.getLeaderAwards(_.profiles[0].id)}async getLeaderAwards(o){_.leaderAwards=[];const i=await z.get(`api/profiles/${o}/awards`);_.leaderAwards=i.data}}const ne=new re;const me={name:"Account",setup(){const a=h(!1),o=h({}),i=h("edit employee record"),t=h([]),g=h({}),b=A(()=>x.value?_.profiles.filter(l=>l.credits>0).sort((l,c)=>c.totalCredits-l.totalCredits):_.profiles.filter(l=>l.credits>0&&new Date(l.updatedAt).getTime()>Date.now-60*de).sort((l,c)=>c.totalCredits-l.totalCredits)),w=A(()=>b.value[0]!=null?b.value[0]:_.profiles.sort((l,c)=>c.totalCredits-l.totalCredits)[0]),x=h(!1);Q(()=>{document.body.style.backgroundImage="radial-gradient(rgba(2, 0, 36, 0), rgba(34, 65, 60, 0.7)), url('/assets/img/bg/Cups-room-cup.png')",C()}),watch(b,()=>{k.log("leaderboard change"),setTimeout(()=>{[...document.querySelectorAll('[data-bs-toggle="popover"]')].map(c=>new W(c))},500)}),X(()=>{ne.getProfiles(),o.value=F({},_.account),p()});function p(){var f;g.value=o.value.favoriteCollectable;const l=(f=_.account.inventory)==null?void 0:f.filter(m=>m.type=="collectable");if(!l)return[];const c={};l.forEach(m=>c[m.id]=m),t.value=Object.keys(c).map(m=>c[m]).sort(m=>m.name==_.account.favoriteCollectable.name?-1:0)}async function C(){try{Z.getAwards()}catch(l){k.error(l),T.error(l)}}return{editMode:a,editable:o,editTip:i,collectables:t,selectedCollectable:g,leaderboard:b,employeeOfCycle:w,showAllTimeLeader:x,account:A(()=>_.account),leaderAwards:A(()=>{var l;return(l=w.value)==null?void 0:l.awards.filter(c=>c.count>0)}),async editAccount(){try{a.value?(o.value.favoriteCollectable=g.value.id,await Z.editAccount(o.value),T.toast("Employee record updated","success"),a.value=!1,i.value="edit employee record"):(a.value=!0,i.value="save record")}catch(l){T.toast(l==null?void 0:l.error),k.error(l)}},swapCollectable(l){let c=l.target.value;g.value=t.value[c]}}}},v=a=>(le("data-v-8622326a"),a=a(),se(),a),_e={class:"container text-center"},ve={class:"row mt-5 about justify-content-center"},ue={class:"col-12 col-lg-5 me-lg-5 mb-3 p-lg-0"},pe={class:"row bg-warning rounded lighten-10 shadow p-3"},he={class:"col-4"},ge={key:0,class:"position-relative"},be=["src"],fe=["src"],ye={class:"col-8 text-start position-relative"},we={key:0,class:"text-primary"},xe=v(()=>e("i",{class:"mdi mdi-google-podcast mx-1"},null,-1)),Ce=v(()=>e("b",null,"Recovered Shipments:",-1)),Ae={class:"text-primary"},ke={key:2},Te=["src"],Se=["max"],Le={class:"col-lg-6 shadow bg-primary lighten-20 rounded p-3 mb-5 position-relative"},Oe={class:"row justify-content-center leader-border p-2 mx-3"},Me={key:0,class:"text-primary darken-30 fs-3 mdi mdi-calendar-star"},Pe={key:1,class:"text-primary darken-30 fs-3 mdi mdi-calendar"},Ee={key:0,class:"col-12 text-center mb-1 fs-4"},Ne=v(()=>e("i",{class:"mdi mdi-cat mx-1"},null,-1)),je=u("All Time Top Employee"),Be=v(()=>e("i",{class:"mdi mdi-cat mx-1"},null,-1)),Ie=[Ne,je,Be],Ve={key:1,class:"col-12 text-center mb-1"},De=v(()=>e("div",{class:"fs-4"},[e("i",{class:"mdi mdi-cat mx-1"}),u("Employee of the Cycle"),e("i",{class:"mdi mdi-cat mx-1"})],-1)),Fe=v(()=>e("div",{class:"text-primary darken-10"},[e("small",null,"(60 days)")],-1)),Ge=[De,Fe],qe={key:2,class:"col-6"},Ue={class:"text-dark"},Re=v(()=>e("i",{class:"mdi mdi-google-podcast mx-1"},null,-1)),ze=v(()=>e("b",null,"Recovered Shipments:",-1)),Ze={class:"text-primary"},He={class:"d-flex flex-wrap"},Je={class:"award-icon m-1"},Ke=["src"],Qe={key:3,class:"col-6"},We={class:"col-6 mb-5"},Xe={class:"position-relative"},Ye=["src"],$e=["src"],et=ae('<section class="row text-primary mt-3" data-v-8622326a><div class="col-4" data-v-8622326a>name</div><div class="col-3" data-v-8622326a><i class="mdi mdi-google-podcast mx-1" data-v-8622326a></i></div><div class="col-2" data-v-8622326a><i class="mdi mdi-package mx-1" data-v-8622326a></i></div><div class="col-3" data-v-8622326a><i class="mdi mdi-smart-card mx-1" data-v-8622326a></i></div></section>',1),tt={class:"row p-0"},ot={class:"leaderboard h-25"},lt={class:"col-12 p-0"},st={class:"col-4 list-border"},at={class:"col-3 list-border"},ct={class:"col-2 list-border"},it={class:"col-3 list-border"};function dt(a,o,i,t,g,b){var C,l,c,f,m,S,L,O,M,P,E,N,j,B;const w=G("UploadButton"),x=G("AwardsThread"),p=Y("tooltip");return d(),r("div",_e,[e("div",ve,[e("div",ue,[e("div",pe,[e("div",he,[t.editMode?(d(),$(w,{key:1,onUploadComplete:o[0]||(o[0]=s=>t.editable.picture=s.url),options:{class:"w-100 btn btn-white form-control px-3 py-5",spinner:"\u{1F431}"}})):(d(),r("div",ge,[e("img",{class:"img-fluid border-2 border-warningS rounded-1",src:t.account.picture,alt:""},null,8,be),e("img",{class:"account-collectable",src:(l=(C=t.account)==null?void 0:C.favoriteCollectable)==null?void 0:l.img,alt:""},null,8,fe)]))]),e("div",ye,[y(e("i",{class:"mdi mdi-cancel me-5 icon selectable text-danger darken-10 p-1 px-2 rounded",onClick:o[1]||(o[1]=s=>t.editMode=!t.editMode)},null,512),[[ee,t.editMode],[p,"cancel","auto"]]),y(e("i",{class:"mdi mdi-pencil icon selectable text-warning darken-40 p-1 px-2 rounded",onClick:o[2]||(o[2]=(...s)=>t.editAccount&&t.editAccount(...s))},null,512),[[p,"edit account","auto"]]),t.editMode?y((d(),r("input",{key:1,class:"form-control w-75",type:"text",placeholder:"Enter Name..","onUpdate:modelValue":o[3]||(o[3]=s=>t.editable.name=s),minlength:"5",maxlength:"15",required:""},null,512)),[[te,t.editable.name]]):(d(),r("h5",we,n(t.account.name),1)),e("div",null,[xe,u(n(t.account.credits),1)]),e("div",null,[Ce,u(" "+n((c=t.account.shipmentsFound)==null?void 0:c.length),1)]),e("h4",null,[e("b",Ae,n((f=t.account)==null?void 0:f.employeeGrade),1)]),t.editMode&&t.collectables.length?(d(),r("div",ke,[e("small",null,[u("favorite collectable: "+n(t.selectedCollectable.name),1),e("img",{class:"item-thumbnail",src:t.selectedCollectable.img,alt:""},null,8,Te)]),e("input",{value:"0",onInput:o[4]||(o[4]=(...s)=>t.swapCollectable&&t.swapCollectable(...s)),type:"range",class:"w-100",min:0,max:t.collectables.length-1},null,40,Se)])):q("",!0)])]),oe(x)]),e("div",Le,[e("section",Oe,[y(e("button",{onClick:o[5]||(o[5]=s=>t.showAllTimeLeader=!t.showAllTimeLeader),class:"leaderboard-button"},[t.showAllTimeLeader?(d(),r("i",Pe)):(d(),r("i",Me))],512),[[p,`${t.showAllTimeLeader?"show cycle":"show all time"}`,"left"]]),t.showAllTimeLeader?(d(),r("div",Ee,Ie)):(d(),r("div",Ve,Ge)),t.employeeOfCycle?(d(),r("div",qe,[e("h5",Ue,n((m=t.employeeOfCycle)==null?void 0:m.name),1),e("div",null,[Re,u(n((S=t.employeeOfCycle)==null?void 0:S.credits),1)]),e("div",null,[ze,u(" "+n((O=(L=t.employeeOfCycle)==null?void 0:L.shipmentsFound)==null?void 0:O.length),1)]),e("h4",null,[e("b",Ze,n(((M=t.employeeOfCycle)==null?void 0:M.topGrade)||((P=t.employeeOfCycle)==null?void 0:P.employeeGrade)),1)]),e("div",He,[(d(!0),r(U,null,R(t.leaderAwards,s=>y((d(),r("div",Je,[e("img",{src:s.img,alt:""},null,8,Ke)],512)),[[p,`${s.name} ${s.count>1?s.count:""}`,"bottom"]])),256))])])):(d(),r("div",Qe,"No employee")),e("div",We,[e("div",Xe,[e("img",{class:"img-fluid border border-primary rounded-1",src:(E=t.employeeOfCycle)==null?void 0:E.picture,alt:""},null,8,Ye),((N=t.employeeOfCycle)==null?void 0:N.favoriteCollectable)?(d(),r("img",{key:0,class:"leader-collectable",src:(B=(j=t.employeeOfCycle)==null?void 0:j.favoriteCollectable)==null?void 0:B.img,alt:""},null,8,$e)):q("",!0)])])]),et,e("section",tt,[e("div",ot,[e("div",lt,[(d(!0),r(U,null,R(t.leaderboard.slice(1),s=>{var I;return d(),r("div",{key:s.id,class:ce(["row mt-2 px-2",{"text-warning":s.id==t.account.id,"text-dark":s.id!=t.account.id}])},[e("div",st,n(s.name),1),e("div",at,n(s.totalCredits),1),e("div",ct,n((I=s.shipmentsFound)==null?void 0:I.length),1),e("div",it,n(s.topGrade||s.employeeGrade),1)],2)}),128))])])])])])])}var _t=ie(me,[["render",dt],["__scopeId","data-v-8622326a"]]);export{_t as default};
